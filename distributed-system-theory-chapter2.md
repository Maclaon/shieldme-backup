---
title: 分布式理论（二）
date: 2015-01-25 10:00:00
tags: 分布式理论，概念
author: maclaon
comments: false
---
# 概念
## 节点
> 节点是指一个可以独立按照分布式协议完成一组逻辑的程序个体，具体的工程项目中，一个节点往往是一个操作系统上的进程。

## 通信
> 节点与节点之间是完全独立、相互隔离的,节点之间传递信息的唯一方式是通过不可靠的网络 进行通信。即一个节点可以向其他节点通过网络发送消息,但发送消息的节点无法确认消息是否被 接收节点完整正确收到。

## 存储
> 节点可以通过将数据写入与节点在同一台机器的本地存储设备保存数据。通常的存储设备有磁盘、SSD 等。存储、读取数据的节点称为有状态的节点,反之称为无状态的节点。

<!--more-->

## 异常
> + 机器宕机
> + 网络异常: 消息丢失、消息乱序、数据错误、不可靠的TCP


异常处理的黄金原则: 任何在设计阶段考虑到的异常情况一定会在 系统实际运行中发生,但在系统实际运行遇到的异常却很有可能在设计时未能考虑,所以,除非需 求指标允许,在系统设计时不能放过任何异常情况。

## 分布式的三态
> + 成功
> + 失败
> + 超时

当出现“超时”时 可以通过发起读取数据的操作以验证 RPC 是否成功(例如银行系统的做法)。另一种简单的做法是, 设计分布式协议时将执行步骤设计为可重试的,即具有**所谓的“幂等性”**。例如覆盖写就是一种常见的幂 等性操作,因为重复的覆盖写最终的结果都相等。

## 副本
副本(replica/copy)指在分布式系统中为数据或服务提供的冗余。对于数据副本指在不同的节 点上持久化同一份数据，当出现某一个节点的存储的数据丢失时，可以从副本上读到数据，数据副本是分布式系统解决数据丢失异常的唯一手段。另一类副本是服务副本，指数个节点提供某种相同的服务，这种服务一般并不依赖于节点的本地存储，其所需数据一般来自其他节点。

### 概念
> 分布式系统通过副本控制协议，使得从系统外部读取系统内部各个副本的数据在一定的约束条件下相同，称之为副本一致性(consistency)。副本一致性是针对分布式系统而言的，不是针对某一个副本而言。

### 分类
+ 强一致性
任何时刻任何用户或节点都可以读到最近一次成功更新的副本数据。强一致性是程度最高的一致性要求，也是实践中最难以实现的一致性。
+ 单调一致性
任何时刻,任何用户一旦读到某个数据在某次更新后的值, 这个用户不会再读到比这个值更旧的值。单调一致性是弱于强一致性却非常实用的一种一致性级别。 因为通常来说，用户只关心从己方视角观察到的一致性，而不会关注其他用户的一致性情况。
+ 会话一致性
任何用户在某一次会话内一旦读到某个数据在某次更新后的值, 这个用户在这次会话过程中不会再读到比这个值更旧的值。
+ 最终一致性
最终一致性要求一旦更新成功,各个副本上的数据最终将达 到完全一致的状态,但达到完全一致状态所需要的时间不能保障。
+ 弱一致性:
一旦某个更新成功，用户无法在一个确定时间内读到这次更新的值，且即使在某个副本上读到了新的值，也不能保证在其他副本上可以读到新的值。

## 衡量分布式系统的指标
+ 性能
+ 可用性
+ 可扩展性
+ 一致性